@page "/gamesearch"
@using ArimaaAnalyzer.Maui.Models
@using ArimaaAnalyzer.Maui.Components
@using ArimaaAnalyzer.Maui.Services

<h1>Gamesearch</h1>

<div class="gamesearch-layout">
    <div class="gs-left">
        <div class="gs-card">
            <GameSearchMenu OnSearch="HandleSearch" />
        </div>
    </div>
    <div class="gs-right">
        <div class="gs-card">
            <GameRecordList Items="_games" PageSize="5" />
        </div>
    </div>
    
</div>

@code {
    private List<GameRecord>? _games = GameRecordService.LoadAll();

    private int HandleSearch(GameRecordService.GameRecordFilterOptions options)
    {
        const int MaxResults = 100;
        _games = GameRecordService.LoadAndFilter(options, MaxResults);
        // No need to call StateHasChanged here; Blazor will re-render after the event by default.
        return _games?.Count ?? 0;
    }
}
